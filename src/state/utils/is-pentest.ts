import {
  PENTEST_PROJECT_TAG,
  PENTEST_PROJECT_PREFIX,
} from '@/constants/projects'

import { Project } from '@/state/types/project'

export function isPentest(project: Project): boolean
export function isPentest(tags: string[], name: string): boolean
export function isPentest(
  projectOrTags: Project | string[],
  name?: string
): boolean {
  let _tags: string[] = []
  let _name = name ?? ''

  if (!Array.isArray(projectOrTags)) {
    _tags = projectOrTags.tags
    _name = projectOrTags.name
  } else {
    _tags = projectOrTags
  }

  return (
    _tags.includes(PENTEST_PROJECT_TAG) ||
    _name.startsWith(PENTEST_PROJECT_PREFIX)
  )
}
